%\chapter*{List of abbreviations}
%The following table describes the significance of various abbreviations and acronyms used throughout the thesis.  
%\begin{table}[h]
%\footnotesize
%\begin{tabular}{c|c}
%\hline
%\textbf{Abbreviation} & \textbf{Meaning} \\
%\hline
%BBGKY & Bogoliubov-Born-Green-Kirkwood-Yvon hierarchy \\
%BSE & Bethe-Salpeter Equation\\
%BZ & Brilluoin Zone\\
%COH & Coulomb-hole  \\
%COHSEX & Coulomb-hole plus Screened Exchange self-energy \\
%DFT & Density Functional Theory   \\
%DFTP & Density Functional Polarisation Theory   \\
%EDA & Electric-dipole Approximation \\
%EOM & Equation of Motion   \\
%GW & GW approximation for self-energy of a many-body system\\
%G$_0$W$_0$ & Zero order of the GW self-energy \\
%HF & Hartree-Fock\\
%HHG & High Harmonic Generation   \\
%IPA & Indepent particle approximation  \\
%IPC & Infinite Periodic Crystal  \\
%KBE & Kadanoff-Baym Equations\\
%KS & Kohn and Sham\\
%KSV & King-Smith Vanderbilt Polarisation\\
%IP & Independent Particle\\
%IPA & Independent Particle Approximation\\
%JGM & Jellium with Gap Model\\
%    & \emph{continued to the next page}   \\
%\end{tabular}
%\end{table}
%
%
%\begin{center}
%\begin{table}
%\footnotesize
%\begin{tabular}{c|c}
%\hline
%\textbf{Abbreviation} & \textbf{Meaning} \\
%\hline
%JGM-PF & Jellium with Gap Model Polarisation Functional\\
%LDA & Local Density Approximation\\
%LRC & Long-range corrected approximation\\
%MBPT & Many-Body Perturbation Theory\\
%opt-PF & optimal Polarisation Functional\\
%PBC & Periodic Boundary Conditions\\
%QPA & Quasi-particle approximation\\
%RPA & Random Phase Approximation (including local field effects)\\
%SEX & Screened Exchange self-energy \\
%SHG & Second Harmonic Generation\\
%THG & Third Harmonic Generation   \\
%TD-BSE & Time-Dependent Bethe-Salpeter Equation   \\
%TDDFT & Time-Dependent Density Functional Theory   \\
%TDCDFT & Time-Dependent Current-Density Functional Theory   \\
%TD-LDA & Time-Dependent Local Density Approximation\\
%TDH/TD-HARTREE & Time-Dependent Hartree   \\
%TDHF & Time-Dependent Hartree-Fock   \\
%TD-KS & Time-Dependent Kohn-Sham   \\
%\end{tabular}
%\end{table}
%\end{center}
                      

\chapter{Introduction to the non-linear optics} 

\section{What is non-linear optics?}
When you immerse a solid, either an insulator or a semiconductor, in an electric field (see Fig. \ref{immerse}), the dipoles inside the material get orientated along the field lines and create an internal field, 
\begin{wrapfigure}{r}{0.5\textwidth}
    \vspace{-0.7cm}
  \begin{center}
    \includegraphics[width=0.4\textwidth]{Figures/immerse}
  \end{center}
  \caption{A solid immersed in an electric field. \label{immerse}}
\end{wrapfigure}
the polarisation $\PPc$, opposite to the field that generates it. This naive picture, even if not correct for extended systems, gives us an idea of the effect of an external electric field on a material.
The total electric field inside the solid $\EEc(\rr,t)$ is the sum of the external plus the polarisation one:
\be
\EEc(\rr,t) = \DDc(\rr,t) - \PPc(\rr,t).
\label{materialeq}
\ee
This equation is one of the so-called  "Materials equations", namely the Maxwell equations for electric and magnetic fields in bulk materials, where $\DDc(\rr,t)$ is the Electric Displacement and $ \EEc(\rr,t)$ is the Total Electric Field. In order to understand the origin of these two fields, it is possible to write down their corresponding Gauss's equations:
\ben
\nabla \DDc(\rr,t)  = \frac{\rho_{ext}(\rr,t)}{\epsilon_0} \mbox{ , } \nabla \EEc(\rr,t)  = \frac{\rho_{tot}(\rr,t)}{\epsilon_0}. 
\een
From the above equations one can see that the Electric Displacement is generated by the external charges while the Electric Field is due to the sum of external plus the internal ones, namely the total charge. This explains the structure of Eq.~\ref{materialeq} being the total field equal to the external one minus the polarisation that is the field generated by the internal charges and  opposed to the external one. In general we can expand the polarisation  $\PPc$ in a power series of the total electric field $\EEc$: 
\be
\PPc = \PPc_0 + \chi^{(1)} \EEc + \chi^{(2)} \EEc^2 + \chi^{(3)} \EEc^3 + ....
\label{pexpansion}
\ee
where $\PPc_0$ is the intrinsic polarisation of the material and  $\chi^{(1)}, \chi^{(2)},...$ are the response functions of increasing order. Equation~\ref{pexpansion} is valid for a wide range of situations. However there are cases where this expansion is not valid: 1) for very strong fields, beyond the convergence radius of the expansion\cite{lee2014first}; 2) when there is an hysteresis and therefore there is not a univocal relation between polarisation and electric field; 3) close to phase transitions where a small external field can completely change the material properties. In this highlight we will not consider any of these cases but we will concentrate on the "simpler" one, when the relation between polarisation and electric field can be written in a power series. 
%Moreover in the present work we will always assume $\PPc_0=0$ because we are not interested in materials with intrinsic polarisation as for instance ferroeletrics.\\
\begin{figure}[ht]
  \begin{center}
    \includegraphics[width=0.9\textwidth]{Figures/SHG_franken.png}
  \end{center}        
  \caption{The original photographic image of the SHG with the corresponding caption from the Franken's paper\cite{franken1961generation}. \label{frankenfig}} % (Onestly I don't see anything below the arrow)
\end{figure}
Now we introduce the concept of non-linear optics. If in Eq.~\ref{pexpansion} we limit the power series to the first term $\chi^{(1)}$ we can describe all the phenomena which belong to the linear optics regime. All the other terms  $\chi^{(2)}, \chi^{(3)},.... $  describe the non-linear response. What does non-linear response mean in practice?  The simplest non-linear phenomena, we obtain from the additional terms,  can be easily understood if we rewrite Eq.~\ref{pexpansion} in frequency domain for an homogeneous material:
\be
\PPc(\omega) = \chi^{(1)} (\omega) \EEc(\omega)  + \chi^{(2)} (\omega = \omega_1 + \omega_2) \EEc(\omega_1) \EEc(\omega_2) + ....
\label{pexpomega}
\ee
From the first term of the RHS we immediately realise that the outgoing light [i.e. the polarisation $\PPc (\omega)$] has the same frequency $\omega$ of the incoming one [i.e. the electric filed $\EEc (\omega)$]. On the contrary terms beyond the linear one contain sum or difference of many electric fields and therefore the outgoing light could have a different frequency, namely a colour different from the incoming one.  For example in the second harmonic generation(SHG), the outgoing light has a frequency that is two times larger than the incoming one. \\
This simple effect, even it is easy to understand and visualise, it is not something evident in our everyday lives. In fact the non-linear coefficients of the polarisation expansion are very small, and therefore in order to obtain a detectable non-linear response one needs a strong light source. This is the reason why the first experimental measurement of second-harmonic generation (SHG) dates 1961\cite{franken1961generation}, just few years after the laser invention.\cite{maiman1960stimulated} In this first experiment of non-linear optics Franken and his collaborators were able to obtain a SHG signal from a ruby crystal employing a monochromatic laser beam with an intensity of $10^5$ volts/cm, see Fig.~\ref{frankenfig}.\\
Nowadays lasers with an intensity equivalent to the one used in the Franken's experiment are commercial available in shops, and SHG became a common technique to double the laser frequency.\\
Of course non-linear optics is not limited to the SHG but the term covers a large spectra of phenomena spanning saturation, sum frequency generation, high harmonic and so on. In the next section we will show some usages and applications of non-linear response.
\section{What can be done with non-linear optics?} 
\begin{wrapfigure}{r}{0.5\textwidth}
    \vspace{-0.7cm}
  \begin{center}
    \includegraphics[width=0.4\textwidth]{Figures/lasergreen}
  \end{center}
  \caption{Schematic of the green laser pointer. \label{greenlaser}}
\end{wrapfigure}
In the last thirty years the field of non-linear spectroscopy\cite{bloembergen1982nonlinear} made progresses in leaps and bounds. The simplest commercial application that everybody knows, is the green laser pointer used in conferences. In this device the green light is obtained combining a red laser with a non-linear crystal that doubles the frequency, see Fig.~\ref{greenlaser}. Nowadays non-linear crystals are routinely used in laboratories to change shape, length and intensity of laser beams. \\
%              \begin{wrapfigure}{l}{0.4\textwidth}
%    \vspace{-0.7cm}
%  \begin{center}
%    \includegraphics[width=0.4\textwidth]{Figures/entangled}
%  \end{center}
%  \caption{Entangled photons generation. \label{entangled}}
%\end{wrapfigure}
        Applications of non-linear optics are not limited to physics, they range from optoelectronics to medicine. \\
        For example nanocrystals with non-linear properties can be bounded to proteins and then inserted in living systems.
        They become a tool to probe protein dynamics. In fact under intense illumination, such as the focus of a laser-scanning microscope, these SHG nanocrystals modify the light colour and thus they can be imaged by means of the two-photon microscopy. Since biological tissue do not present a particular non-linear response, scientists can visualise the dynamics of the proteins thanks to the nanocrystals.        
        Unlike commonly used fluorescent probes, SHG nanoprobes neither bleach nor blink. The resulting contrast and detectability of SHG nanoprobes provided therefore unique advantages for molecular imaging of living cells and tissues. \cite{pantazis2010second}

  
In quantum optics, non-linear crystals are used to create entangled photons. A photon at high energy is transformed in two or more photons with lower energy by means of reverse second or third harmonic generation. These news outgoing photons can be used in quantum information studies, quantum cryptography or for quantum computation, due to their entangled states.\cite{PhysRevLett.75.4337}\\ 
%(see Fig.~\ref{entangled}).\cite{PhysRevLett.75.4337}\\ 
\begin{wrapfigure}{l}{0.4\textwidth}
    \vspace{-0.7cm}
  \begin{center}
    \includegraphics[width=0.4\textwidth]{Figures/ferroelectric}
  \end{center}
  \caption{Square root of SHG signal changing due to temperature variation, in a BaTiO$_3$ crystal. \label{ferroelectric}}
\end{wrapfigure}
In condensed matter the non-linear response remains an essential tool to characterise and explore electronic and structural properties of materials. 
For example, since second harmonic generation can be produced only in materials that lack of inversion symmetry, it became a tool to probe phase transitions and phenomena the break this symmetry. \\
In presence of a macroscopic electric field as the one of piezoelectrics, pyroelectrics, and ferroelectrics or a bulk magnetizations as in ferromagnets the inversion symmetry is broken and a simple SHG measurement as function of the temperature can be used to discriminate between the different phases of these materials. In Fig.~\ref{ferroelectric} it is shown how the SHG signal changes with the temperature in the ferroelectric BaTiO$_3$. At 120\degree~C there is no more signal and the change is very abrupt. 
This confirms that 120\degree~C is the temperature where inversion symmetry is restored in BaTiO$_3$ crystal as it loses its ferroelectric properties.\\
Another import application of non-linear response is the characterisation of surfaces and interfaces. Since SHG is much more sensitive to the lattice orientation, compared with linear optics, it can be used to scan a layer deposited on a surface and to identify  dimension and orientation of the different flakes. 
In a recent experiment~\cite{yin2014edge}  X. Yin et al. used this idea to develop a nonlinear optical imaging technique that allows a rapid and all-optical determination of the crystal orientations in 2D materials at a large scale. In Fig.~\ref{mos2} one sees the main results of  X. Yin et al., on the left there is an image of a single-layer of MoS$_2$ in linear optics and on the right a SHG image of the same layer, where the different colours represent different intensity of the SHG response. The flakes and their orientation are clearly visible in the SHG image.
\begin{wrapfigure}{r}{0.4\textwidth}
    \vspace{-0.7cm}
  \begin{center}
    \includegraphics[width=0.4\textwidth]{Figures/mos2}
  \end{center}
  \caption{On the left a linear optics image of a  MoS$_2$ single layer. On the right SHG image of the same layer. \label{mos2} [Figure from Ref.\cite{yin2014edge}]}
\end{wrapfigure}
Instead, Y. Li at al. used SHG to probe the number of layers deposited on a surface, using the fact that an even number of layers posses inversion symmetry while an odd one does not.\cite{doi:10.1021/nl401561r}\\
Another domain where SHG plays a major role is surface spectroscopy. One of the problem occurring to experimentalists is to disentangle bulk from surface contribution in their measurements. SHG is one of the few techniques that can probe the surface without the contributions from the bulk. The reason lies in the fact that in solids with inversion symmetries the bulk contribution is zero and the only source of SHG is the surface one. This is true not only for bulk materials but also for liquids that are in average symmetric but not at the liquid-liquid or gas-liquid interfaces. In  this cases SHG provides  great insights on the surface structure that sometime are difficult to probe with other techniques.\cite{eisenthal1996liquid} \\ 
The importance of non-linear response for solids characterisation is not limited to the SHG, but also other response functions find applications in condensed matter physics. For example two-photon absorption that is proportional to the imaginary part of the $\chi^{(3)}$ can be used to probe excited states that are dark in linear optics.\cite{wang2005optical,cassabois2015hexagonal}\\ 
Finally we want to conclude this section showing some negative sides of the non-linear response. While in many applications the non-linear response is the desired effect, there are cases where one tries to avoid any non-linear phenomena. 
For example one of the limiting factor of the light power that can be transported by optical fibers is the self-focusing phenomena. Self-focusing is a non-linear optical process generated by the third harmonic response in materials exposed to intense electromagnetic radiation. 
A medium whose refractive index is modified by the $\chi^{(3)}$ response acts as a focusing lens for an electromagnetic wave characterised by an initial transverse intensity gradient, as the one generated by a laser beam (see Fig.~\ref{selffocusing}). 


The peak intensity of the self-focused region keeps increasing as the wave travels through the medium until medium damage interrupts this process. At present no method is known for increasing the self-focusing limit in optical fibers\cite{encylaser}.\\
\begin{wrapfigure}{r}{0.4\textwidth}
 \vspace{-0.8cm}
\begin{center}
\includegraphics[width=0.4\textwidth]{Figures/selffocus}
\end{center}
\vspace{-0.5cm}
\caption{A schematic representation of the self-focusing phenomena in optical fibers. \label{selffocusing}}
\end{wrapfigure}           
In this section we covered a minimal part of the positive and negative non-linear phenomena in research and applications, for a general overview different books and reviews are available in literature.\cite{boyd,bloembergen1982nonlinear}
\section{How to calculate non-linear response}
The first attempt to calculate non-linear optical response in solids from a quantum mechanics was done by means of density matrix formalism.\cite{bloembergen1964quantum} This formalism was already used in the past to derive local field effects in linear optics\cite{PhysRev.126.413,wiser1963dielectric}, to investigate  a non-linear phenomena like saturation of microwave resonances\cite{karplus1948note}, and to describe nuclear magnetic relaxation\cite{kubo1954general,RevModPhys.33.249,PhysRev.102.104}.              
One particular advantage of this formalism is that it allows to include damping in an easy way.\\  
The Hamiltonian that enters in the equations of motion(EOM) [Eq.~\ref{eomsimple}] for the density matrix\cite{neumann} can be decomposed in three parts:   $\HH_A$ that determines the unperturbed energy levels of the system, $\HH_{coh}$ that describes the coupling  with the external perturbation, in our case a monochromatic electro-magnetic field, and finally $\HH_{random}$ that includes all relaxation processes.\\
We can thus write down the EOM for the density matrix as:
\be
i \hbar \frac{\partial \rho}{\partial t} = [ \HH_A, \rho] + [ \HH_{coh}, \rho] + i\hbar \left ( \frac{\partial \rho}{\partial t} \right )_{damping}.
\label{eomsimple}
\ee
The last term of this equation is the one generated by the random processes  $\HH_{random}$ and it is due to the coupling with phonon modes, external environments or generated by the electronic correlation. In the literature different phenomenological models have been proposed for the damping therm, the simplest one is:
\be
\left ( \frac{\partial \rho}{\partial t} \right )_{damping} = - \left (\Gamma \rho + \rho \Gamma \right ).
\label{dmeq}
\ee
Where the anti-commutator on the RHS is generated by the non-Hermitian part of the Hamiltonian.\cite{tokman}\\
A steady-state solution for EOM [Eq.~\ref{eomsimple}] in ascending powers of the coupling term may be found from the following hierarchy equations:
\bea
i \hbar \frac{\partial \rho^{(0)}}{\partial t} &=& [ \HH_A, \rho^{(0)}] +  i\hbar \left ( \frac{\partial \rho^{(0)}}{\partial t} \right )_{damping}\\ 
i \hbar \frac{\partial \rho^{(1)}}{\partial t} &=& [ \HH_A, \rho^{(1)}] + [ \HH_{coh}, \rho^{(0)}] + i\hbar \left ( \frac{\partial \rho^{(1)}}{\partial t} \right )_{damping} \\
i \hbar \frac{\partial \rho^{(2)}}{\partial t} &=& [ \HH_A, \rho^{(2)}] + [ \HH_{coh}, \rho^{(1)}] + i\hbar \left ( \frac{\partial \rho^{(2)}}{\partial t} \right )_{damping}. 
\eea
The first equation gives the density matrix at equilibrium. The second equation describes the linear response. By Fourier analysis it is easy to show that $\rho^{(1)}$ must contain the same frequencies as $\HH_{coh}$. The $\rho^{(2)}$  is the first non-linear term. Differently from $\rho^{(1)}$,  $\rho^{(2)}$ oscillates at a frequency that can be the sum or difference of the incoming fields. This term describes second harmonic generation and optical rectification and the dc term. The other terms   $\rho^{(n)}$, describes higher harmonic generations, saturation phenomena and so on.
From these hierarchy equations it is possible to derive the corresponding equations for the response functions $\chi^{(1)}$, $\chi^{(2)}$ ... by differentiating the density matrix respect to the external perturbation. \\
Density matrix formalism is not the only possibility to calculate non-linear response. Expressions for the second order response functions can be also derived directly from perturbation theory.\cite{PhysRevB.56.1787,PhysRevB.42.3567,PhysRevB.82.235201} \\
In the both the methods mentioned above, the response functions and their corresponding Dyson equations are generally expressed by means of sum over states, i. e. valence and conduction bands.\\
Expressing response functions in terms of valence and conduction bands has the advantage to make easy the interpretation of the different peaks appearing in the  $\chi^{(1)}$, $\chi^{(2)}$ ...., however calculations can become prohibitive as the number of bands and k-points increases. For this reason, some groups took a different road to calculate non-linear response functions. Dal Corso and Mauri used the "2n+1" theorem in the time-dependent density functional theory (TDDFT) framework to calculate static nonlinear susceptibilities avoiding the sum over states.\cite{PhysRevB.50.5756}
Other groups used a frequency dependent Sternheimer equation to obtain dynamic polarisabilities and hyperpolarizabilities in molecular systems.\cite{andrade2007time} \\
Finally there is the possibility to follow in real-time the excitation of the system, by solving Eq.~\ref{dmeq} and then analysing the outgoing polarisation or current. Although the real-time solution has a better scaling  with the system size  than  previous mentioned approaches, it is not so common in the scientific literature. The reasons are twofold: first the real-time solution has a large prefactor in the computational time  and therefore only for large systems it starts to become more convenient, and second results analysis is more involved that in the other methods. \\ 
However in last years different works appeared in the literature that use real-time propagation to calculate non-linear response both for molecular\cite{takimoto:154114,ding2013efficient} and periodic systems.\cite{goncharov2013nonlinear}\\
In the next chapters I will present a new real-time approach to study  non-linear response in extended systems that offers different advantages respect the previous methods.\cite{nloptics2013}

\subsection{Correlation effects and non-linear response}
Until now we discussed how to calculate non-linear response but we did not say anything about correlation effects neither on the Hamiltonian that appears in Eq.~\ref{dmeq}. In this section we  briefly outline the different approaches used in the past to take into account these effects in the non-linear response.\\
The first calculations of non-linear response were based on empirical pseudo-potentials, often underestimating or overestimating the experimental values by one or two order of magnitudes.\cite{PhysRevB.12.2325,PhysRevB.36.9708}
In the nineties Levine\cite{PhysRevB.42.3567} presented for the first time an \emph{ab-initio} formalism for the calculation of the second-harmonic generation. Sipe and coworkers extended the calculation of non-linear response to the third harmonic generation eliminating  unphysical divergences that are present in the velocity gauge.\cite{PhysRevB.61.5337,PhysRevB.48.11705}\\ 
Calculations based on ab-initio band structures already improved results respect to previous approaches, however correlation effects were not taken in account yet. Few years later, again Levine and coworkers presented the first calculations of the second harmonic generation including local-field effects and self-energy effects by means of a scissor operator.\cite{PhysRevLett.63.1719,PhysRevB.56.1787} \\
Beyond these effects only a few works included electron-hole interaction in the non-linear response. In particular excitonic effects have been derived by Green's function theory and included by means of generalisations of Bethe-Salpeter equation (BSE)\cite{strinati} to higher order response functions. Following this idea Chang et al.\cite{Chang2002}  and Leitsman et al.\cite{Leitsmann2005} presented an \emph{ab-initio} many body framework for computing the frequency dependent second-harmonic generation that includes local fields and excitonic effects through an effective two-particle Hamiltonian derived from the BSE and found a good agreement with the experimental results.\\
More recently Hubener\cite{PhysRevA.83.062122} presented a full Bethe-Salpeter equation for the second order response functions, while Virk and Sipe derived a similar equation for the third harmonic generation.\cite{PhysRevB.56.1787}\\
Another possible way to include correlation effects, alternative to the Green's function theory, is Time-Dependent Density Functional Theory (TDDFT)\cite{PhysRevLett.52.997}. TDDFT is in principle an exact theory to calculate response functions in finite systems. However the exchange-correlation functional that enters in the equations is unknown and has to be approximated. Standard approximations that rely on local or semi-local functionials miss long range contributions that are responsible of excitonic effects\cite{botti2007time}. Long range contribution can be included in reciprocal or real-space or obtained by means of hybrid functionals\cite{botti2007time,faber2014excited}. For extended systems the situation is more complicated since TDDFT is not an exact theory for the optical response (see Chapter~\ref{chaptertddft} for a discussion).\\
Despite of these problems, TDDFT has been used to calculate linear and non-linear response functions in both finite and extended systems, often with very good results, and also in its real-time formulation.\cite{takimoto:154114,andrade2007time} 
%In the next chapters we will discuss how to extended this approach to periodic systems including also excitonic effects.\cite{PhysRevB.82.235201,gruningtddf1,gruningtddf2} 
